{% extends 'basic.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'css/video_details.css' %}" />
{% endblock %}
{% block html %}
<main class="video-detail">
    <!-- Video Thumbnail and Information -->
    <div class="video-detail__thumbnail">
        <img src="{{ video.thumbnail.url }}" alt="{{ video.title }}">
    </div>
    <div class="video-detail__info">
        <h1>{{ video.title }}</h1>
        <p>{{ video.description }}</p>
        <p>Views: {{ video.views }}</p>
        <p>Uploaded on: {{ video.upload_date|date:"d M Y" }}</p>

        <!-- Like Button -->
        <p>Likes: {{ video.total_likes }}</p>
        {% if user.is_authenticated %}
            <form action="{% url 'like_video' video.id %}" method="post">
                {% csrf_token %}
                {% if user in video.likes.all %}
                    <button type="submit" class="btn btn-danger">Unlike</button>
                {% else %}
                    <button type="submit" class="btn btn-primary">Like</button>
                {% endif %}
            </form>
        {% else %}
            <p><a href="{% url 'login' %}">Log in to like this video</a></p>
        {% endif %}
    </div>

    <!-- Video Player -->
    <div class="video-detail__player">
        <video controls poster="{{ video.thumbnail.url }}" muted loop>
            <source src="{{ video.video_file.url }}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    {% comment %} <!-- Comments Section -->
    <div class="video-detail__comments">
        <h3>Comments</h3>
        {% for comment in video.comments.all %}
        <div class="comment">
            <p><strong>{{ comment.author.username }}</strong> said:</p>
            <p>{{ comment.content }}</p>
            <p><small>{{ comment.created_at|date:"d M Y H:i" }}</small></p>
        </div>
        {% empty %}
        <p>No comments yet.</p>
        {% endfor %}
    </div>

    <!-- Comment Form -->
    <div class="video-detail__comment-form">
        <h3>Leave a Comment</h3>
        <form action="{% url 'add_comment' video.id %}" method="post">
            {% csrf_token %}
            <textarea name="content" rows="4" placeholder="Write your comment here..." required></textarea>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div> {% endcomment %}
</main>
{% endblock %}
